"use strict";(()=>{var a={};a.id=142,a.ids=[142],a.modules={261:a=>{a.exports=require("next/dist/shared/lib/router/utils/app-paths")},3295:a=>{a.exports=require("next/dist/server/app-render/after-task-async-storage.external.js")},10846:a=>{a.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},19121:a=>{a.exports=require("next/dist/server/app-render/action-async-storage.external.js")},29021:a=>{a.exports=require("fs")},29294:a=>{a.exports=require("next/dist/server/app-render/work-async-storage.external.js")},33873:a=>{a.exports=require("path")},44870:a=>{a.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},51606:(a,b,c)=>{c.d(b,{$A:()=>j,AD:()=>q,Bo:()=>r,Gy:()=>l,Lf:()=>o,Ny:()=>i,Xi:()=>p,dP:()=>k,sS:()=>h,sr:()=>g,yv:()=>n,z7:()=>m});var d=c(59507);let e=d.Ikc({page:d.aig().int().positive().default(1),limit:d.aig().int().positive().max(100).default(20),sortBy:d.YjP().optional(),sortOrder:d.k5n(["asc","desc"]).default("desc")}),f=d.Ikc({dateFrom:d.p6U().optional(),dateTo:d.p6U().optional()}),g=e.extend({agentType:d.YjP().optional(),status:d.k5n(["pending","running","completed","failed","cancelled"]).optional(),nodeId:d.YjP().optional(),triggeredBy:d.k5n(["manual","schedule","webhook"]).optional()}).merge(f),h=d.Ikc({agentType:d.YjP().min(1,"Agent type is required"),nodeId:d.YjP().optional(),triggeredBy:d.k5n(["manual","schedule","webhook"]).default("manual"),config:d.g1P(d.YjP(),d.bzn()).optional(),metadata:d.g1P(d.YjP(),d.bzn()).optional()}),i=d.Ikc({status:d.k5n(["pending","running","completed","failed","cancelled"]).optional(),completedAt:d.YjP().datetime().optional(),durationMs:d.aig().int().nonnegative().optional(),costUsd:d.aig().nonnegative().optional(),tokensUsed:d.aig().int().nonnegative().optional(),resultSummary:d.YjP().optional(),errorMessage:d.YjP().optional(),exitCode:d.aig().int().optional(),logs:d.YjP().optional(),aiAnalysis:d.YjP().optional(),rawOutput:d.YjP().optional()}),j=d.Ikc({includeSteps:d.zMY().default(!1),includeCosts:d.zMY().default(!1),includeConfig:d.zMY().default(!1),includeLogs:d.zMY().default(!1)}),k=d.Ikc({agentType:d.YjP().min(1,"Agent type is required").regex(/^[a-z][a-z0-9-]*[a-z0-9]$/,"Agent type must be lowercase, alphanumeric with hyphens"),name:d.YjP().min(1,"Name is required"),description:d.YjP().optional(),version:d.YjP().regex(/^\d+\.\d+\.\d+$/,"Version must follow semantic versioning (e.g., 1.0.0)").optional(),enabled:d.zMY().default(!0),config:d.YjP().optional(),maxCostPerExecution:d.aig().nonnegative().optional(),maxDurationMs:d.aig().int().positive().optional(),timeoutMs:d.aig().int().positive().optional(),maxConcurrentExecutions:d.aig().int().min(1).optional(),cooldownMs:d.aig().int().nonnegative().optional()}),l=k.partial().omit({agentType:!0}),m=d.Ikc({enabled:d.zMY().optional(),orderBy:d.k5n(["name","agentType","createdAt","updatedAt"]).default("name"),orderDirection:d.k5n(["asc","desc"]).default("asc")}).merge(e),n=d.Ikc({executionId:d.YjP().min(1,"Execution ID is required"),modelUsed:d.YjP().min(1,"Model is required"),inputTokens:d.aig().int().nonnegative(),outputTokens:d.aig().int().nonnegative(),inputCostUsd:d.aig().nonnegative(),outputCostUsd:d.aig().nonnegative(),totalCostUsd:d.aig().nonnegative(),requestId:d.YjP().optional(),responseTime:d.aig().nonnegative().optional(),cacheHit:d.zMY().optional()}),o=d.Ikc({agentType:d.YjP().optional(),modelUsed:d.YjP().optional(),executionId:d.YjP().optional(),groupBy:d.k5n(["day","week","month","agent","model"]).optional(),includeBreakdown:d.zMY().default(!1),includeProjections:d.zMY().default(!1)}).merge(f).merge(e),p=d.Ikc({period:d.k5n(["day","week","month"]).default("day"),days:d.aig().int().positive().max(365).default(30)});d.Ikc({name:d.YjP().min(1,"Name is required"),agentType:d.YjP().min(1,"Agent type is required"),cronExpression:d.YjP().min(1,"Cron expression is required"),timezone:d.YjP().default("UTC"),enabled:d.zMY().default(!0),nodeIds:d.YOg(d.YjP()).optional(),executionConfig:d.g1P(d.YjP(),d.bzn()).optional(),maxExecutions:d.aig().int().positive().optional()}).partial().omit({agentType:!0});let q=d.Ikc({includeDatabase:d.zMY().default(!0),includeFileSystem:d.zMY().default(!0),includeExternalServices:d.zMY().default(!0)});d.Ikc({nodeId:d.YjP().default("localhost"),cpuUsagePercent:d.aig().min(0).max(100).optional(),memoryUsagePercent:d.aig().min(0).max(100).optional(),diskUsagePercent:d.aig().min(0).max(100).optional(),loadAverage1m:d.aig().nonnegative().optional(),loadAverage5m:d.aig().nonnegative().optional(),loadAverage15m:d.aig().nonnegative().optional(),diskFreeBytes:d.aig().nonnegative().optional(),diskTotalBytes:d.aig().positive().optional(),internetConnected:d.zMY().optional(),claudeApiLatencyMs:d.aig().nonnegative().optional(),overallHealth:d.k5n(["healthy","degraded","unhealthy"]).optional()});let r=d.Ikc({nodeId:d.YjP().default("localhost"),timeframe:d.k5n(["hour","day","week","month"]).default("day"),metrics:d.YjP().optional(),healthStatus:d.k5n(["healthy","warning","critical"]).optional(),limit:d.aig().int().positive().max(1e3).default(100),offset:d.aig().int().nonnegative().default(0)}).merge(f);d.Ikc({operations:d.YOg(d.Ikc({action:d.k5n(["create","update","delete"]),data:d.KCZ([h,i]),id:d.YjP().optional()})).min(1).max(100)}),d.Ikc({query:d.YjP().min(1,"Search query is required"),type:d.k5n(["executions","agents","schedules","logs"]).optional(),filters:d.g1P(d.YjP(),d.bzn()).optional()}).merge(e),d.Ikc({type:d.k5n(["executions","costs","config","all"]),format:d.k5n(["json","csv","excel"]),filters:d.g1P(d.YjP(),d.bzn()).optional()}).merge(f)},56726:(a,b,c)=>{c.r(b),c.d(b,{handler:()=>J,patchFetch:()=>I,routeModule:()=>E,serverHooks:()=>H,workAsyncStorage:()=>F,workUnitAsyncStorage:()=>G});var d={};c.r(d),c.d(d,{GET:()=>D,dynamic:()=>A,revalidate:()=>C,runtime:()=>B});var e=c(95736),f=c(9117),g=c(4044),h=c(39326),i=c(32324),j=c(261),k=c(54290),l=c(85328),m=c(38928),n=c(46595),o=c(3421),p=c(17679),q=c(41681),r=c(63446),s=c(86439),t=c(51356),u=c(1003),v=c(51606),w=c(71491),x=c(85766),y=c(29021),z=c(33873);let A="force-dynamic",B="nodejs",C=0,D=(0,u.FB)(async a=>{let b=a.nextUrl.searchParams,c=(0,u.fe)(b,v.AD),d={database:{status:"down"},fileSystem:{status:"down"},externalServices:{claude:{status:"down"}}},e="healthy";if(c.includeDatabase)try{let a=Date.now();await w.db.execute((0,x.ll)`SELECT 1 as test`);let b=Date.now()-a;d.database={status:"up",responseTime:b}}catch(a){d.database={status:"down",error:a instanceof Error?a.message:"Database connection failed"},e="unhealthy"}if(c.includeFileSystem)try{let a=(0,z.join)(process.cwd(),"data");await y.promises.access(a),await y.promises.stat(a);let b="function"==typeof y.promises.statfs?await y.promises.statfs(a).catch(()=>null):null;d.fileSystem={status:"up",freeSpace:b?.bavail?b.bavail*b.bsize:void 0,totalSpace:b?.blocks?b.blocks*b.bsize:void 0}}catch(a){d.fileSystem={status:"down",error:a instanceof Error?a.message:"File system check failed"},"unhealthy"!==e&&(e="degraded")}if(c.includeExternalServices)try{let a=Date.now(),b=Date.now()-a;d.externalServices.claude={status:"up",responseTime:b}}catch(a){d.externalServices.claude={status:"down",error:a instanceof Error?a.message:"Claude API check failed"},"unhealthy"!==e&&(e="degraded")}let f=1e3*process.uptime(),g={status:e,timestamp:new Date().toISOString(),checks:d,version:process.env.npm_package_version||"0.1.0",uptime:f};return(0,u.$y)(g)}),E=new e.AppRouteRouteModule({definition:{kind:f.RouteKind.APP_ROUTE,page:"/api/system/health/route",pathname:"/api/system/health",filename:"route",bundlePath:"app/api/system/health/route"},distDir:".next",relativeProjectDir:"",resolvedPagePath:"/home/jmagar/code/agents/src/app/api/system/health/route.ts",nextConfigOutput:"standalone",userland:d}),{workAsyncStorage:F,workUnitAsyncStorage:G,serverHooks:H}=E;function I(){return(0,g.patchFetch)({workAsyncStorage:F,workUnitAsyncStorage:G})}async function J(a,b,c){var d;let e="/api/system/health/route";"/index"===e&&(e="/");let g=await E.prepare(a,b,{srcPage:e,multiZoneDraftMode:!1});if(!g)return b.statusCode=400,b.end("Bad Request"),null==c.waitUntil||c.waitUntil.call(c,Promise.resolve()),null;let{buildId:u,params:v,nextConfig:w,isDraftMode:x,prerenderManifest:y,routerServerContext:z,isOnDemandRevalidate:A,revalidateOnlyGenerated:B,resolvedPathname:C}=g,D=(0,j.normalizeAppPath)(e),F=!!(y.dynamicRoutes[D]||y.routes[C]);if(F&&!x){let a=!!y.routes[C],b=y.dynamicRoutes[D];if(b&&!1===b.fallback&&!a)throw new s.NoFallbackError}let G=null;!F||E.isDev||x||(G="/index"===(G=C)?"/":G);let H=!0===E.isDev||!F,I=F&&!H,J=a.method||"GET",K=(0,i.getTracer)(),L=K.getActiveScopeSpan(),M={params:v,prerenderManifest:y,renderOpts:{experimental:{cacheComponents:!!w.experimental.cacheComponents,authInterrupts:!!w.experimental.authInterrupts},supportsDynamicResponse:H,incrementalCache:(0,h.getRequestMeta)(a,"incrementalCache"),cacheLifeProfiles:null==(d=w.experimental)?void 0:d.cacheLife,isRevalidate:I,waitUntil:c.waitUntil,onClose:a=>{b.on("close",a)},onAfterTaskError:void 0,onInstrumentationRequestError:(b,c,d)=>E.onRequestError(a,b,d,z)},sharedContext:{buildId:u}},N=new k.NodeNextRequest(a),O=new k.NodeNextResponse(b),P=l.NextRequestAdapter.fromNodeNextRequest(N,(0,l.signalFromNodeResponse)(b));try{let d=async c=>E.handle(P,M).finally(()=>{if(!c)return;c.setAttributes({"http.status_code":b.statusCode,"next.rsc":!1});let d=K.getRootSpanAttributes();if(!d)return;if(d.get("next.span_type")!==m.BaseServerSpan.handleRequest)return void console.warn(`Unexpected root span type '${d.get("next.span_type")}'. Please report this Next.js issue https://github.com/vercel/next.js`);let e=d.get("next.route");if(e){let a=`${J} ${e}`;c.setAttributes({"next.route":e,"http.route":e,"next.span_name":a}),c.updateName(a)}else c.updateName(`${J} ${a.url}`)}),g=async g=>{var i,j;let k=async({previousCacheEntry:f})=>{try{if(!(0,h.getRequestMeta)(a,"minimalMode")&&A&&B&&!f)return b.statusCode=404,b.setHeader("x-nextjs-cache","REVALIDATED"),b.end("This page could not be found"),null;let e=await d(g);a.fetchMetrics=M.renderOpts.fetchMetrics;let i=M.renderOpts.pendingWaitUntil;i&&c.waitUntil&&(c.waitUntil(i),i=void 0);let j=M.renderOpts.collectedTags;if(!F)return await (0,o.I)(N,O,e,M.renderOpts.pendingWaitUntil),null;{let a=await e.blob(),b=(0,p.toNodeOutgoingHttpHeaders)(e.headers);j&&(b[r.NEXT_CACHE_TAGS_HEADER]=j),!b["content-type"]&&a.type&&(b["content-type"]=a.type);let c=void 0!==M.renderOpts.collectedRevalidate&&!(M.renderOpts.collectedRevalidate>=r.INFINITE_CACHE)&&M.renderOpts.collectedRevalidate,d=void 0===M.renderOpts.collectedExpire||M.renderOpts.collectedExpire>=r.INFINITE_CACHE?void 0:M.renderOpts.collectedExpire;return{value:{kind:t.CachedRouteKind.APP_ROUTE,status:e.status,body:Buffer.from(await a.arrayBuffer()),headers:b},cacheControl:{revalidate:c,expire:d}}}}catch(b){throw(null==f?void 0:f.isStale)&&await E.onRequestError(a,b,{routerKind:"App Router",routePath:e,routeType:"route",revalidateReason:(0,n.c)({isRevalidate:I,isOnDemandRevalidate:A})},z),b}},l=await E.handleResponse({req:a,nextConfig:w,cacheKey:G,routeKind:f.RouteKind.APP_ROUTE,isFallback:!1,prerenderManifest:y,isRoutePPREnabled:!1,isOnDemandRevalidate:A,revalidateOnlyGenerated:B,responseGenerator:k,waitUntil:c.waitUntil});if(!F)return null;if((null==l||null==(i=l.value)?void 0:i.kind)!==t.CachedRouteKind.APP_ROUTE)throw Object.defineProperty(Error(`Invariant: app-route received invalid cache entry ${null==l||null==(j=l.value)?void 0:j.kind}`),"__NEXT_ERROR_CODE",{value:"E701",enumerable:!1,configurable:!0});(0,h.getRequestMeta)(a,"minimalMode")||b.setHeader("x-nextjs-cache",A?"REVALIDATED":l.isMiss?"MISS":l.isStale?"STALE":"HIT"),x&&b.setHeader("Cache-Control","private, no-cache, no-store, max-age=0, must-revalidate");let m=(0,p.fromNodeOutgoingHttpHeaders)(l.value.headers);return(0,h.getRequestMeta)(a,"minimalMode")&&F||m.delete(r.NEXT_CACHE_TAGS_HEADER),!l.cacheControl||b.getHeader("Cache-Control")||m.get("Cache-Control")||m.set("Cache-Control",(0,q.getCacheControlHeader)(l.cacheControl)),await (0,o.I)(N,O,new Response(l.value.body,{headers:m,status:l.value.status||200})),null};L?await g(L):await K.withPropagatedContext(a.headers,()=>K.trace(m.BaseServerSpan.handleRequest,{spanName:`${J} ${a.url}`,kind:i.SpanKind.SERVER,attributes:{"http.method":J,"http.target":a.url}},g))}catch(b){if(L||b instanceof s.NoFallbackError||await E.onRequestError(a,b,{routerKind:"App Router",routePath:D,routeType:"route",revalidateReason:(0,n.c)({isRevalidate:I,isOnDemandRevalidate:A})}),F)throw b;return await (0,o.I)(N,O,new Response(null,{status:500})),null}}},63033:a=>{a.exports=require("next/dist/server/app-render/work-unit-async-storage.external.js")},77598:a=>{a.exports=require("node:crypto")},86439:a=>{a.exports=require("next/dist/shared/lib/no-fallback-error.external")},87550:a=>{a.exports=require("better-sqlite3")}};var b=require("../../../../webpack-runtime.js");b.C(a);var c=b.X(0,[586,923,213],()=>b(b.s=56726));module.exports=c})();