exports.id=213,exports.ids=[213],exports.modules={1003:(a,b,c)=>{"use strict";c.d(b,{$y:()=>i,FB:()=>h,fe:()=>l,sq:()=>j,sv:()=>k});var d=c(10641),e=c(59507);class f extends Error{constructor(a,b=500,c="INTERNAL_ERROR"){super(a),this.statusCode=b,this.code=c,this.name="ApiError"}}class g extends f{constructor(a,b,c){super(a,400,"VALIDATION_ERROR"),this.field=b,this.value=c}}function h(a){return async(b,...c)=>{try{return await a(b,...c)}catch(a){return function(a,b=500){let c=new Date().toISOString();if(a instanceof e.GaX){let b=a.issues.map(a=>({field:a.path.join("."),message:a.message,value:a.received}));return d.NextResponse.json({success:!1,error:{code:"VALIDATION_ERROR",message:"Validation failed",details:{validationErrors:b}},timestamp:c},{status:400})}return a instanceof f?d.NextResponse.json({success:!1,error:{code:a.code,message:a.message,details:a instanceof g?{field:a.field,value:a.value}:void 0},timestamp:c},{status:a.statusCode}):(a instanceof Error&&a.message,console.error("Unhandled API error:",a),d.NextResponse.json({success:!1,error:{code:"INTERNAL_ERROR",message:"Internal server error"},timestamp:c},{status:b}))}(a)}}}function i(a,b=200){return d.NextResponse.json({success:!0,data:a,timestamp:new Date().toISOString()},{status:b})}async function j(a,b=200){let c=await a();if(!c.success)throw new f(c.error||"Operation failed");return i(c.data,b)}function k(a,b){try{return b.parse(a)}catch(a){if(a instanceof e.GaX)throw a;throw new g("Invalid request body")}}function l(a,b){let c=Object.entries(Object.fromEntries(a)).reduce((a,[b,c])=>{if(["page","limit","offset","pageSize"].includes(b)){let d=parseInt(c);a[b]=isNaN(d)?c:d}else["includeSteps","includeCosts","includeConfig","enabled"].includes(b)?a[b]="true"===c:b.includes("Date")||b.includes("At")?a[b]=c?new Date(c):c:a[b]=c;return a},{});try{return b.parse(c)}catch(a){if(a instanceof e.GaX)throw a;throw new g("Invalid query parameters")}}},27628:(a,b,c)=>{"use strict";c.r(b),c.d(b,{agentConfigurations:()=>n,appSettings:()=>q,costTracking:()=>l,costTrackingRelations:()=>u,executionSteps:()=>k,executionStepsRelations:()=>t,executions:()=>j,executionsRelations:()=>s,monthlyCostSummaries:()=>m,schedules:()=>o,schedulesRelations:()=>v,systemMetrics:()=>p});var d=c(95417),e=c(58040),f=c(20377),g=c(19643),h=c(4035),i=c(87280);let j=(0,d.D)("executions",{id:(0,e.Qq)("id").primaryKey().$defaultFn(()=>(0,i.sX)()),agentType:(0,e.Qq)("agent_type").notNull(),status:(0,e.Qq)("status",{enum:["pending","running","completed","failed","cancelled"]}).notNull().default("pending"),startedAt:(0,e.Qq)("started_at").notNull().$defaultFn(()=>new Date().toISOString()),completedAt:(0,e.Qq)("completed_at"),durationMs:(0,f.nd)("duration_ms"),costUsd:(0,g.x)("cost_usd"),tokensUsed:(0,f.nd)("tokens_used"),nodeId:(0,e.Qq)("node_id"),triggeredBy:(0,e.Qq)("triggered_by"),resultSummary:(0,e.Qq)("result_summary"),errorMessage:(0,e.Qq)("error_message"),exitCode:(0,f.nd)("exit_code"),logs:(0,e.Qq)("logs"),aiAnalysis:(0,e.Qq)("ai_analysis"),rawOutput:(0,e.Qq)("raw_output"),executionContext:(0,e.Qq)("execution_context"),createdAt:(0,e.Qq)("created_at").notNull().$defaultFn(()=>new Date().toISOString()),updatedAt:(0,e.Qq)("updated_at").notNull().$defaultFn(()=>new Date().toISOString())},a=>({execStatusIdx:(0,h.Pe)("exec_status_idx").on(a.status),execAgentTypeIdx:(0,h.Pe)("exec_agent_type_idx").on(a.agentType),execStartedAtIdx:(0,h.Pe)("exec_started_at_idx").on(a.startedAt),execCostIdx:(0,h.Pe)("exec_cost_idx").on(a.costUsd),execNodeIdx:(0,h.Pe)("exec_node_idx").on(a.nodeId),execStatusAgentIdx:(0,h.Pe)("exec_status_agent_idx").on(a.status,a.agentType),execDateRangeIdx:(0,h.Pe)("exec_date_range_idx").on(a.startedAt,a.completedAt)})),k=(0,d.D)("execution_steps",{id:(0,e.Qq)("id").primaryKey().$defaultFn(()=>(0,i.sX)()),executionId:(0,e.Qq)("execution_id").notNull().references(()=>j.id,{onDelete:"cascade"}),stepNumber:(0,f.nd)("step_number").notNull(),stepName:(0,e.Qq)("step_name").notNull(),stepType:(0,e.Qq)("step_type"),status:(0,e.Qq)("status",{enum:["pending","running","completed","failed","skipped"]}).notNull().default("pending"),startedAt:(0,e.Qq)("started_at").$defaultFn(()=>new Date().toISOString()),completedAt:(0,e.Qq)("completed_at"),durationMs:(0,f.nd)("duration_ms"),output:(0,e.Qq)("output"),errorMessage:(0,e.Qq)("error_message"),metadata:(0,e.Qq)("metadata"),createdAt:(0,e.Qq)("created_at").notNull().$defaultFn(()=>new Date().toISOString())},a=>({stepsExecutionIdx:(0,h.Pe)("steps_execution_idx").on(a.executionId),stepsNumberIdx:(0,h.Pe)("steps_number_idx").on(a.executionId,a.stepNumber)})),l=(0,d.D)("cost_tracking",{id:(0,e.Qq)("id").primaryKey().$defaultFn(()=>(0,i.sX)()),executionId:(0,e.Qq)("execution_id").references(()=>j.id,{onDelete:"cascade"}),modelUsed:(0,e.Qq)("model_used").notNull(),inputTokens:(0,f.nd)("input_tokens").notNull().default(0),outputTokens:(0,f.nd)("output_tokens").notNull().default(0),inputCostUsd:(0,g.x)("input_cost_usd").notNull().default(0),outputCostUsd:(0,g.x)("output_cost_usd").notNull().default(0),totalCostUsd:(0,g.x)("total_cost_usd").notNull().default(0),requestId:(0,e.Qq)("request_id"),responseTime:(0,f.nd)("response_time_ms"),cacheHit:(0,f.nd)("cache_hit",{mode:"boolean"}).default(!1),timestamp:(0,e.Qq)("timestamp").notNull().$defaultFn(()=>new Date().toISOString()),year:(0,f.nd)("year").notNull(),month:(0,f.nd)("month").notNull(),day:(0,f.nd)("day").notNull()},a=>({costExecutionIdx:(0,h.Pe)("cost_execution_idx").on(a.executionId),costDateIdx:(0,h.Pe)("cost_date_idx").on(a.year,a.month,a.day),costMonthlyIdx:(0,h.Pe)("cost_monthly_idx").on(a.year,a.month),costTotalIdx:(0,h.Pe)("cost_total_idx").on(a.totalCostUsd)})),m=(0,d.D)("monthly_cost_summaries",{id:(0,e.Qq)("id").primaryKey().$defaultFn(()=>(0,i.sX)()),year:(0,f.nd)("year").notNull(),month:(0,f.nd)("month").notNull(),totalCostUsd:(0,g.x)("total_cost_usd").notNull().default(0),totalExecutions:(0,f.nd)("total_executions").notNull().default(0),totalTokens:(0,f.nd)("total_tokens").notNull().default(0),avgCostPerExecution:(0,g.x)("avg_cost_per_execution").notNull().default(0),avgTokensPerExecution:(0,g.x)("avg_tokens_per_execution").notNull().default(0),costByAgentType:(0,e.Qq)("cost_by_agent_type"),lastUpdated:(0,e.Qq)("last_updated").notNull().$defaultFn(()=>new Date().toISOString())},a=>({summaryYearMonthIdx:(0,h.Pe)("summary_year_month_idx").on(a.year,a.month)})),n=(0,d.D)("agent_configurations",{id:(0,e.Qq)("id").primaryKey().$defaultFn(()=>(0,i.sX)()),agentType:(0,e.Qq)("agent_type").notNull().unique(),name:(0,e.Qq)("name").notNull(),description:(0,e.Qq)("description"),version:(0,e.Qq)("version").notNull().default("1.0.0"),enabled:(0,f.nd)("enabled",{mode:"boolean"}).notNull().default(!0),config:(0,e.Qq)("config"),maxCostPerExecution:(0,g.x)("max_cost_per_execution"),maxDurationMs:(0,f.nd)("max_duration_ms"),timeoutMs:(0,f.nd)("timeout_ms").default(3e5),maxConcurrentExecutions:(0,f.nd)("max_concurrent_executions").default(1),cooldownMs:(0,f.nd)("cooldown_ms").default(0),createdAt:(0,e.Qq)("created_at").notNull().$defaultFn(()=>new Date().toISOString()),updatedAt:(0,e.Qq)("updated_at").notNull().$defaultFn(()=>new Date().toISOString())},a=>({configAgentTypeIdx:(0,h.Pe)("config_agent_type_idx").on(a.agentType),configEnabledIdx:(0,h.Pe)("config_enabled_idx").on(a.enabled)})),o=(0,d.D)("schedules",{id:(0,e.Qq)("id").primaryKey().$defaultFn(()=>(0,i.sX)()),name:(0,e.Qq)("name").notNull(),agentType:(0,e.Qq)("agent_type").notNull().references(()=>n.agentType),cronExpression:(0,e.Qq)("cron_expression").notNull(),timezone:(0,e.Qq)("timezone").notNull().default("UTC"),enabled:(0,f.nd)("enabled",{mode:"boolean"}).notNull().default(!0),nextRun:(0,e.Qq)("next_run"),lastRun:(0,e.Qq)("last_run"),nodeIds:(0,e.Qq)("node_ids"),executionConfig:(0,e.Qq)("execution_config"),maxExecutions:(0,f.nd)("max_executions"),executionsCount:(0,f.nd)("executions_count").notNull().default(0),createdAt:(0,e.Qq)("created_at").notNull().$defaultFn(()=>new Date().toISOString()),updatedAt:(0,e.Qq)("updated_at").notNull().$defaultFn(()=>new Date().toISOString())},a=>({scheduleAgentTypeIdx:(0,h.Pe)("schedule_agent_type_idx").on(a.agentType),scheduleEnabledIdx:(0,h.Pe)("schedule_enabled_idx").on(a.enabled),scheduleNextRunIdx:(0,h.Pe)("schedule_next_run_idx").on(a.nextRun)})),p=(0,d.D)("system_metrics",{id:(0,e.Qq)("id").primaryKey().$defaultFn(()=>(0,i.sX)()),nodeId:(0,e.Qq)("node_id").notNull().default("localhost"),cpuUsagePercent:(0,g.x)("cpu_usage_percent"),memoryUsagePercent:(0,g.x)("memory_usage_percent"),diskUsagePercent:(0,g.x)("disk_usage_percent"),loadAverage1m:(0,g.x)("load_average_1m"),loadAverage5m:(0,g.x)("load_average_5m"),loadAverage15m:(0,g.x)("load_average_15m"),diskFreeBytes:(0,f.nd)("disk_free_bytes"),diskTotalBytes:(0,f.nd)("disk_total_bytes"),internetConnected:(0,f.nd)("internet_connected",{mode:"boolean"}),claudeApiLatencyMs:(0,f.nd)("claude_api_latency_ms"),overallHealth:(0,e.Qq)("overall_health",{enum:["healthy","warning","critical"]}).notNull().default("healthy"),timestamp:(0,e.Qq)("timestamp").notNull().$defaultFn(()=>new Date().toISOString())},a=>({metricsNodeTimestampIdx:(0,h.Pe)("metrics_node_timestamp_idx").on(a.nodeId,a.timestamp),metricsHealthIdx:(0,h.Pe)("metrics_health_idx").on(a.overallHealth),metricsTimestampIdx:(0,h.Pe)("metrics_timestamp_idx").on(a.timestamp)})),q=(0,d.D)("app_settings",{id:(0,e.Qq)("id").primaryKey().$defaultFn(()=>(0,i.sX)()),key:(0,e.Qq)("key").notNull().unique(),value:(0,e.Qq)("value").notNull(),description:(0,e.Qq)("description"),valueType:(0,e.Qq)("value_type",{enum:["string","number","boolean","json"]}).notNull().default("string"),category:(0,e.Qq)("category").notNull().default("general"),isSecret:(0,f.nd)("is_secret",{mode:"boolean"}).notNull().default(!1),isReadonly:(0,f.nd)("is_readonly",{mode:"boolean"}).notNull().default(!1),createdAt:(0,e.Qq)("created_at").notNull().$defaultFn(()=>new Date().toISOString()),updatedAt:(0,e.Qq)("updated_at").notNull().$defaultFn(()=>new Date().toISOString())},a=>({settingsKeyIdx:(0,h.Pe)("settings_key_idx").on(a.key),settingsCategoryIdx:(0,h.Pe)("settings_category_idx").on(a.category)}));var r=c(30248);let s=(0,r.K1)(j,({many:a,one:b})=>({steps:a(k),costBreakdown:a(l),agentConfig:b(n,{fields:[j.agentType],references:[n.agentType]})})),t=(0,r.K1)(k,({one:a})=>({execution:a(j,{fields:[k.executionId],references:[j.id]})})),u=(0,r.K1)(l,({one:a})=>({execution:a(j,{fields:[l.executionId],references:[j.id]})})),v=(0,r.K1)(o,({one:a})=>({agentConfig:a(n,{fields:[o.agentType],references:[n.agentType]})}))},71491:(a,b,c)=>{"use strict";c.d(b,{db:()=>l});var d=c(64947),e=c(87550),f=c.n(e),g=c(27628),h=c(33873),i=c(29021);class j{constructor(){this.config={...{path:h.join(process.cwd(),"data","development.db"),maxConnections:10,busyTimeout:5e3,journalMode:"WAL",synchronous:"NORMAL",cacheSize:1e6},path:h.join(process.cwd(),"data","production.db"),backupPath:h.join(process.cwd(),"backups"),synchronous:"NORMAL",cacheSize:2e6},this.ensureDataDirectory(),this.sqlite=new(f())(this.config.path),this.configureSQLite(),this.db=(0,d.f)(this.sqlite,{schema:g,logger:!1})}static getInstance(){return j.instance||(j.instance=new j),j.instance}ensureDataDirectory(){if(":memory:"===this.config.path)return;let a=h.dirname(this.config.path);i.existsSync(a)||i.mkdirSync(a,{recursive:!0}),this.config.backupPath&&!i.existsSync(this.config.backupPath)&&i.mkdirSync(this.config.backupPath,{recursive:!0})}configureSQLite(){this.sqlite.pragma(`journal_mode = ${this.config.journalMode}`),this.sqlite.pragma(`synchronous = ${this.config.synchronous}`),this.sqlite.pragma(`cache_size = ${this.config.cacheSize}`),this.sqlite.pragma("temp_store = MEMORY"),this.sqlite.pragma("foreign_keys = ON"),this.sqlite.pragma(`busy_timeout = ${this.config.busyTimeout}`)}getDb(){return this.db}getSQLite(){return this.sqlite}close(){this.sqlite.close()}healthCheck(){try{return this.sqlite.prepare("SELECT 1").get(),!0}catch{return!1}}getConfig(){return{...this.config}}}let k=j.getInstance(),l=k.getDb();k.getSQLite()},78335:()=>{},96487:()=>{}};